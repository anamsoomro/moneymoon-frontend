{"ast":null,"code":"var _jsxFileName = \"/Users/flatironstudent/Desktop/moneys/frontend/src/components/Link.js\";\nimport React, { Component } from \"react\";\nimport { PlaidLink, usePlaidLink } from \"react-plaid-link\";\nimport { connect } from 'react-redux';\nimport { trackPromise } from 'react-promise-tracker';\n\nclass Link extends Component {\n  constructor(...args) {\n    super(...args);\n\n    this.handleOnSuccess = (public_token, metadata) => {\n      trackPromise(fetch(\"http://localhost:3000/get_access_token\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${localStorage.token}`\n        },\n        body: JSON.stringify({\n          public_token: public_token,\n          user_id: localStorage.user_id,\n          institution: metadata.institution.name // always inject it in the back end\n\n        })\n      }).then(resp => resp.json()).then(data => {\n        if (data.error) {\n          alert(data.error);\n        } else {\n          // transactions have account_ids, need to add account_names and institution\n          let transactions = data.transactions.map(tran => {\n            let account = data.accounts.filter(acc => {\n              // this seems expensive way of doing this\n              return acc.account_id === tran.account_id;\n            }); // return {...tran, account_name: account[0].name, institution: metadata.institution.name}\n\n            return { ...tran,\n              account_name: account[0].name\n            };\n          });\n          this.props.addData({\n            transactions: transactions,\n            accounts: data.accounts\n          });\n          this.props.handleDisplay();\n          this.props.setUserView();\n        }\n      }));\n    };\n  }\n\n  render(props) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(PlaidLink, {\n      style: this.props.styling // style={{background: \"transparent\", border: \"0px\", color: \"#fff\"}}\n      ,\n      clientName: \"Moneymoon\",\n      env: \"sandbox\" // \"development\"\n      ,\n      product: [\"transactions\"] // product={[\"auth\", \"transactions\"]} what ddoes this actually do \n      ,\n      publicKey: \"38e9fa8478f20a384db53c1176e9b7\",\n      onExit: this.handleOnExit,\n      onSuccess: this.handleOnSuccess,\n      className: \"test\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 9\n      }\n    }, this.props.text));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    user_id: state.authReducer.user.id\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    addData: data => dispatch({\n      type: \"addData\",\n      data: data\n    }),\n    handleDisplay: () => dispatch({\n      type: \"handleDisplay\"\n    })\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Link);","map":{"version":3,"sources":["/Users/flatironstudent/Desktop/moneys/frontend/src/components/Link.js"],"names":["React","Component","PlaidLink","usePlaidLink","connect","trackPromise","Link","handleOnSuccess","public_token","metadata","fetch","method","headers","Authorization","localStorage","token","body","JSON","stringify","user_id","institution","name","then","resp","json","data","error","alert","transactions","map","tran","account","accounts","filter","acc","account_id","account_name","props","addData","handleDisplay","setUserView","render","styling","handleOnExit","text","mapStateToProps","state","authReducer","user","id","mapDispatchToProps","dispatch","type"],"mappings":"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","sourcesContent":["\nimport React, { Component } from \"react\";\nimport { PlaidLink, usePlaidLink }from \"react-plaid-link\";\nimport {connect} from 'react-redux'\nimport { trackPromise } from 'react-promise-tracker'\n\n\nclass Link extends Component {\n\n  handleOnSuccess = (public_token, metadata) => {\n    trackPromise(\n    fetch(\"http://localhost:3000/get_access_token\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${localStorage.token}`\n      },\n      body: JSON.stringify({\n        public_token: public_token,\n        user_id: localStorage.user_id, \n        institution: metadata.institution.name // always inject it in the back end\n      })\n    })\n    .then(resp => resp.json())\n    .then(data => {\n      if (data.error){\n        alert(data.error)\n      } else {\n        // transactions have account_ids, need to add account_names and institution\n        let transactions = data.transactions.map( tran => {\n          let account = data.accounts.filter( acc => { // this seems expensive way of doing this\n            return acc.account_id === tran.account_id\n          })\n          // return {...tran, account_name: account[0].name, institution: metadata.institution.name}\n          return {...tran, account_name: account[0].name}\n\n        })\n        this.props.addData({ \n          transactions: transactions, \n          accounts: data.accounts\n        })\n        this.props.handleDisplay()\n        \n        this.props.setUserView()\n      }\n    })\n    )\n  }\n\n  \n\n  render(props) {\n    return (\n      <div>\n        <PlaidLink\n          style={this.props.styling}\n          // style={{background: \"transparent\", border: \"0px\", color: \"#fff\"}}\n          clientName=\"Moneymoon\"\n          env=\"sandbox\" // \"development\"\n          product={[\"transactions\"]} // product={[\"auth\", \"transactions\"]} what ddoes this actually do \n          publicKey=\"38e9fa8478f20a384db53c1176e9b7\"\n          onExit={this.handleOnExit}\n          onSuccess={this.handleOnSuccess}\n          className=\"test\">\n          {this.props.text}\n        </PlaidLink>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return { \n    user_id: state.authReducer.user.id\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    addData: ( (data) => dispatch({type: \"addData\", data: data})),\n    handleDisplay: ( () => dispatch({type: \"handleDisplay\"}))\n  }\n} \n\nexport default connect(mapStateToProps, mapDispatchToProps)(Link);\n"]},"metadata":{},"sourceType":"module"}