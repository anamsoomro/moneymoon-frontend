{"ast":null,"code":"var _jsxFileName = \"/Users/flatironstudent/Desktop/moneys/frontend/src/App.js\";\n// import React from \"react\";\nimport React, { useEffect } from \"react\";\nimport \"./App.css\"; // import Link from \"./components/Link\";\n\nimport Dash from \"./containers/Dash\";\nimport Welcome from \"./containers/Welcome\";\nimport Month from \"./containers/Month\";\nimport Trends from \"./containers/Trends\";\nimport { BrowserRouter, Route, Switch } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport NavBar from \"./components/NavBar\"; // import NoAccounts from './components/NoAccounts' // idk how to conditionall render this\n\nimport { trackPromise } from 'react-promise-tracker';\n\nfunction App(props) {\n  useEffect(() => {\n    if (localStorage.token) {\n      trackPromise(fetch(`http://localhost:3000/accounts/${props.account_id}/get_data`, {\n        method: \"GET\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${localStorage.token}`\n        }\n      }).then(resp => resp.json()).then(data => {\n        if (!!data.transactions.length) {\n          // if user has no plaid items {trans: [], accounts: []}\n          // for as many items this acount has. each object in array is a link item\n          let allAccounts = [];\n          data.accounts.map(item => item.map(account => allAccounts.push(account)));\n          let allTransactions = [];\n          data.transactions.map(item => item.map(transaction => allTransactions.push(transaction))); // accounts have account_ids and names \n          // transactions have account_ids, need to add account_names\n\n          allTransactions = allTransactions.map(tran => {\n            let account = allAccounts.filter(acc => {\n              // this seems expensive way of doing this\n              return acc.account_id === tran.account_id; // find the account matchinig this transaction\n            });\n            return { ...tran,\n              account_name: account[0].name\n            }; // return transaction with that accounts name\n          });\n          props.storeData({\n            transactions: allTransactions,\n            accounts: allAccounts\n          });\n          props.handleDisplay();\n        }\n      }));\n    }\n  }, [props.user]); // run if props.user changes\n\n  const renderRoutes = () => {\n    if (props.user.id) {\n      // if refresh page, then logout. doesnt redirect to login page\n      // if(localStorage.token){ // without using props.user, app does not get re rendered\n      return /*#__PURE__*/React.createElement(BrowserRouter, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(NavBar, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(Switch, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Route, {\n        exact: true,\n        path: \"/\",\n        render: routerProps => /*#__PURE__*/React.createElement(Dash, Object.assign({}, routerProps, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 63\n          }\n        })),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(Route, {\n        exact: true,\n        path: \"/month\",\n        render: routerProps => /*#__PURE__*/React.createElement(Month, Object.assign({}, routerProps, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 68\n          }\n        })),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(Route, {\n        exact: true,\n        path: \"/trends\",\n        render: routerProps => /*#__PURE__*/React.createElement(Trends, Object.assign({}, routerProps, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 69\n          }\n        })),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 15\n        }\n      })));\n    } else {\n      return /*#__PURE__*/React.createElement(Welcome, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 11\n        }\n      });\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 5\n    }\n  }, renderRoutes());\n}\n\nconst mapStateToProps = state => {\n  return {\n    user: state.authReducer.user,\n    account_id: state.authReducer.account.id,\n    accounts: state.linkReducer.accounts\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    storeData: data => dispatch({\n      type: \"storeData\",\n      data: data\n    }),\n    // data = {transactions: [...], accounts: [...]}\n    handleDisplay: () => dispatch({\n      type: \"handleDisplay\"\n    })\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);","map":{"version":3,"sources":["/Users/flatironstudent/Desktop/moneys/frontend/src/App.js"],"names":["React","useEffect","Dash","Welcome","Month","Trends","BrowserRouter","Route","Switch","connect","NavBar","trackPromise","App","props","localStorage","token","fetch","account_id","method","headers","Authorization","then","resp","json","data","transactions","length","allAccounts","accounts","map","item","account","push","allTransactions","transaction","tran","filter","acc","account_name","name","storeData","handleDisplay","user","renderRoutes","id","routerProps","mapStateToProps","state","authReducer","linkReducer","mapDispatchToProps","dispatch","type"],"mappings":"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","sourcesContent":["\n// import React from \"react\";\nimport React, { useEffect } from \"react\"\nimport \"./App.css\";\n// import Link from \"./components/Link\";\nimport Dash from \"./containers/Dash\"\nimport Welcome from \"./containers/Welcome\"\nimport Month from \"./containers/Month\"\nimport Trends from \"./containers/Trends\"\nimport {BrowserRouter, Route, Switch} from 'react-router-dom'\nimport {connect} from 'react-redux'\nimport NavBar from \"./components/NavBar\";\n// import NoAccounts from './components/NoAccounts' // idk how to conditionall render this\nimport { trackPromise } from 'react-promise-tracker'\n\n\nfunction App(props) {\n\n  useEffect( () =>{\n    if (localStorage.token){ \n      trackPromise(\n      fetch(`http://localhost:3000/accounts/${props.account_id}/get_data`, {\n        method: \"GET\", \n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${localStorage.token}`\n        }\n      })\n      .then(resp => resp.json())\n      .then(data => {\n        if (!!data.transactions.length){ // if user has no plaid items {trans: [], accounts: []}\n          // for as many items this acount has. each object in array is a link item\n          let allAccounts = []\n          data.accounts.map( item => item.map(account => allAccounts.push(account)))\n          let allTransactions = [] \n          data.transactions.map( item => item.map(transaction => allTransactions.push(transaction)))\n          // accounts have account_ids and names \n          // transactions have account_ids, need to add account_names\n          allTransactions = allTransactions.map(tran =>{\n            let account = allAccounts.filter(acc => { // this seems expensive way of doing this\n              return acc.account_id === tran.account_id // find the account matchinig this transaction\n            })\n            return {...tran, account_name: account[0].name} // return transaction with that accounts name\n          })\n          props.storeData({transactions: allTransactions, accounts: allAccounts})\n          props.handleDisplay()\n        }\n      })\n      )\n    }\n  }, [props.user]) // run if props.user changes\n\n\n  const renderRoutes = () => {\n    if(props.user.id){ // if refresh page, then logout. doesnt redirect to login page\n    // if(localStorage.token){ // without using props.user, app does not get re rendered\n      return(\n        <BrowserRouter>\n          <NavBar />\n            <Switch>\n              {/* {\n                !!props.accounts.length\n                ? (<Route exact path=\"/\" render={ (routerProps) => <Dash {...routerProps} /> } />\n                  <Route exact path=\"/month\" render={ (routerProps) => <Month {...routerProps}/> } />\n                  <Route exact path=\"/trends\" render={ (routerProps) => <Trends {...routerProps}/> } />)\n\n                : <NoAccounts />\n              } */}\n              <Route exact path=\"/\" render={ (routerProps) => <Dash {...routerProps} /> } />\n              <Route exact path=\"/month\" render={ (routerProps) => <Month {...routerProps}/> } />\n              <Route exact path=\"/trends\" render={ (routerProps) => <Trends {...routerProps}/> } />\n            </Switch>\n        </BrowserRouter>  \n      )\n    } else { \n      return (\n          <Welcome />\n      )\n    }\n  }\n\n  return (\n    <div>\n      {renderRoutes()}\n    </div>\n  )\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    user: state.authReducer.user,\n    account_id: state.authReducer.account.id,\n    accounts: state.linkReducer.accounts\n  }\n} \n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    storeData: ( (data) => dispatch({type: \"storeData\", data: data}) ), // data = {transactions: [...], accounts: [...]}\n    handleDisplay: ( () => dispatch({type: \"handleDisplay\"}))\n  }\n} \n\nexport default connect(mapStateToProps, mapDispatchToProps)(App)"]},"metadata":{},"sourceType":"module"}