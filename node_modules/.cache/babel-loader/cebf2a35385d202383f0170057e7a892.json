{"ast":null,"code":"var _jsxFileName = \"/Users/flatironstudent/Desktop/moneys/frontend/src/components/Link.js\";\nimport React, { Component } from \"react\";\nimport { PlaidLink } from \"react-plaid-link\";\nimport { connect } from 'react-redux';\n\nclass Link extends Component {\n  constructor(...args) {\n    super(...args);\n\n    this.handleOnSuccess = (public_token, metadata) => {\n      fetch(\"http://localhost:3000/get_access_token\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${localStorage.token}`\n        },\n        body: JSON.stringify({\n          public_token: public_token,\n          user_id: this.props.user_id // shouldnt this come from store. no store will go blank on page refresh \n\n        })\n      }).then(resp => resp.json()).then(data => {\n        console.log(\"sweet now you got a access token and some data\");\n        console.log(data);\n\n        if (data.error) {\n          alert(data.error);\n        } else {\n          debugger; // let allAccounts = []\n          // data.accounts.map( item => item.map(account => allAccounts.push(account)))\n          // let allTransactions = [] \n          // data.transactions.map( item => item.map(transaction => allTransactions.push(transaction)))\n          // props.storeData({transactions: allTransactions, accounts: allAccounts})\n\n          this.props.storeData({\n            // this overwrites wth this instutution, we need to add it\n            transactions: data.transactions.transactions,\n            accounts: data.accounts.accounts\n          });\n        }\n      });\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 42,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(PlaidLink, {\n      clientName: \"front-end\",\n      env: \"sandbox\" // \"development\"\n      ,\n      product: [\"transactions\"] // product={[\"auth\", \"transactions\"]} what ddoes this actually do \n      ,\n      publicKey: \"38e9fa8478f20a384db53c1176e9b7\",\n      onExit: this.handleOnExit,\n      onSuccess: this.handleOnSuccess,\n      className: \"test\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 43,\n        columnNumber: 9\n      }\n    }, \"Open Link and connect your bank!\"));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    user_id: state.authReducer.user.id\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    storeData: data => dispatch({\n      type: \"storeData\",\n      data: data\n    }) // data = {transactions: [...], accounts: [...]}\n\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Link);","map":{"version":3,"sources":["/Users/flatironstudent/Desktop/moneys/frontend/src/components/Link.js"],"names":["React","Component","PlaidLink","connect","Link","handleOnSuccess","public_token","metadata","fetch","method","headers","Authorization","localStorage","token","body","JSON","stringify","user_id","props","then","resp","json","data","console","log","error","alert","storeData","transactions","accounts","render","handleOnExit","mapStateToProps","state","authReducer","user","id","mapDispatchToProps","dispatch","type"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,SAAT,QAAyB,kBAAzB;AACA,SAAQC,OAAR,QAAsB,aAAtB;;AAEA,MAAMC,IAAN,SAAmBH,SAAnB,CAA6B;AAAA;AAAA;;AAAA,SAE3BI,eAF2B,GAET,CAACC,YAAD,EAAeC,QAAf,KAA4B;AAC5CC,MAAAA,KAAK,CAAC,wCAAD,EAA2C;AAC9CC,QAAAA,MAAM,EAAE,MADsC;AAE9CC,QAAAA,OAAO,EAAE;AACP,0BAAgB,kBADT;AAEPC,UAAAA,aAAa,EAAG,UAASC,YAAY,CAACC,KAAM;AAFrC,SAFqC;AAM9CC,QAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AACnBV,UAAAA,YAAY,EAAEA,YADK;AAEnBW,UAAAA,OAAO,EAAE,KAAKC,KAAL,CAAWD,OAFD,CAES;;AAFT,SAAf;AANwC,OAA3C,CAAL,CAWCE,IAXD,CAWMC,IAAI,IAAIA,IAAI,CAACC,IAAL,EAXd,EAYCF,IAZD,CAYMG,IAAI,IAAI;AACZC,QAAAA,OAAO,CAACC,GAAR,CAAY,gDAAZ;AACAD,QAAAA,OAAO,CAACC,GAAR,CAAYF,IAAZ;;AACA,YAAIA,IAAI,CAACG,KAAT,EAAe;AACbC,UAAAA,KAAK,CAACJ,IAAI,CAACG,KAAN,CAAL;AACD,SAFD,MAEO;AACL,mBADK,CAEL;AACA;AACA;AACA;AACA;;AACA,eAAKP,KAAL,CAAWS,SAAX,CAAqB;AAAE;AACrBC,YAAAA,YAAY,EAAEN,IAAI,CAACM,YAAL,CAAkBA,YADb;AAEnBC,YAAAA,QAAQ,EAAEP,IAAI,CAACO,QAAL,CAAcA;AAFL,WAArB;AAID;AACF,OA7BD;AA8BD,KAjC0B;AAAA;;AAmC3BC,EAAAA,MAAM,GAAG;AACP,wBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,SAAD;AACE,MAAA,UAAU,EAAC,WADb;AAEE,MAAA,GAAG,EAAC,SAFN,CAEgB;AAFhB;AAGE,MAAA,OAAO,EAAE,CAAC,cAAD,CAHX,CAG6B;AAH7B;AAIE,MAAA,SAAS,EAAC,gCAJZ;AAKE,MAAA,MAAM,EAAE,KAAKC,YALf;AAME,MAAA,SAAS,EAAE,KAAK1B,eANlB;AAOE,MAAA,SAAS,EAAC,MAPZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CADF,CADF;AAcD;;AAlD0B;;AAqD7B,MAAM2B,eAAe,GAAIC,KAAD,IAAW;AACjC,SAAO;AACLhB,IAAAA,OAAO,EAAEgB,KAAK,CAACC,WAAN,CAAkBC,IAAlB,CAAuBC;AAD3B,GAAP;AAGD,CAJD;;AAMA,MAAMC,kBAAkB,GAAIC,QAAD,IAAc;AACvC,SAAO;AACLX,IAAAA,SAAS,EAAKL,IAAD,IAAUgB,QAAQ,CAAC;AAACC,MAAAA,IAAI,EAAE,WAAP;AAAoBjB,MAAAA,IAAI,EAAEA;AAA1B,KAAD,CAD1B,CAC8D;;AAD9D,GAAP;AAGD,CAJD;;AAMA,eAAenB,OAAO,CAAC6B,eAAD,EAAkBK,kBAAlB,CAAP,CAA6CjC,IAA7C,CAAf","sourcesContent":["import React, { Component } from \"react\";\nimport { PlaidLink }from \"react-plaid-link\";\nimport {connect} from 'react-redux'\n\nclass Link extends Component {\n\n  handleOnSuccess = (public_token, metadata) => {\n    fetch(\"http://localhost:3000/get_access_token\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${localStorage.token}`\n      },\n      body: JSON.stringify({\n        public_token: public_token,\n        user_id: this.props.user_id // shouldnt this come from store. no store will go blank on page refresh \n      })\n    })\n    .then(resp => resp.json())\n    .then(data => {\n      console.log(\"sweet now you got a access token and some data\")\n      console.log(data)\n      if (data.error){\n        alert(data.error)\n      } else {\n        debugger\n        // let allAccounts = []\n        // data.accounts.map( item => item.map(account => allAccounts.push(account)))\n        // let allTransactions = [] \n        // data.transactions.map( item => item.map(transaction => allTransactions.push(transaction)))\n        // props.storeData({transactions: allTransactions, accounts: allAccounts})\n        this.props.storeData({ // this overwrites wth this instutution, we need to add it\n          transactions: data.transactions.transactions, \n          accounts: data.accounts.accounts\n        })\n      }\n    })\n  }\n\n  render() {\n    return (\n      <div>\n        <PlaidLink\n          clientName=\"front-end\"\n          env=\"sandbox\" // \"development\"\n          product={[\"transactions\"]} // product={[\"auth\", \"transactions\"]} what ddoes this actually do \n          publicKey=\"38e9fa8478f20a384db53c1176e9b7\"\n          onExit={this.handleOnExit}\n          onSuccess={this.handleOnSuccess}\n          className=\"test\">\n          Open Link and connect your bank!\n        </PlaidLink>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return { \n    user_id: state.authReducer.user.id\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    storeData: ( (data) => dispatch({type: \"storeData\", data: data}) ) // data = {transactions: [...], accounts: [...]}\n  }\n} \n\nexport default connect(mapStateToProps, mapDispatchToProps)(Link);\n"]},"metadata":{},"sourceType":"module"}